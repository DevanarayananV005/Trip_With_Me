<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}"> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            overflow-y: scroll; /* Enable vertical scrolling */
        }

        /* Hide scrollbar for IE, Edge and Firefox */
        body {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        /* Hide scrollbar for Chrome, Safari and Opera */
        body::-webkit-scrollbar {
            display: none;
        }

        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .content {
            padding-top: 68px; /* Adjust based on navbar height */
        }

        .section {
            padding: 60px 0; /* Adjust spacing as needed */
        }

        #carouselExample {
            margin-top: 68px; /* Adjust margin to account for the fixed navbar */
        }
        .notification-icon {
            font-size: 24px;
            color: #333;
            cursor: pointer;
            text-decoration: none; /* Remove underline */
        }
        .notification-icon.new-message {
            color: green; /* Red for new messages */
        }
        .notification-icon.no-message {
            color: #999999; /* Gray for no messages */
        }
        .package-card {
            width: 300px;
            height: 450px;
            margin: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .package-image {
            height: 200px;
            overflow: hidden;
        }
        .package-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .package-details {
            padding: 15px;
            position: relative; /* Add position relative */
        }
        .package-details h3 {
            margin-top: 0;
            color: #e0e0e0;
            font-weight: bold; /* Make location text bold */
        }
        .show-details-btn {
            bottom: 15px;
            right: 15px;
            background-color: #009be3; /* Change button background color */
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .show-details-btn:hover {
            background-color: #007bb5;
        }
        .arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0,0,0,0.5);
            color: white;
            border: none;
            padding: 15px; /* Increase padding for better visibility */
            font-size: 24px; /* Increase font size for better visibility */
            cursor: pointer;
            z-index: 10;
        }
        .left-arrow {
            left: 10px;
        }
        .right-arrow {
            right: 10px;
        }
        .view-all-link {
            text-align: center;
            margin-top: 20px; /* Add space between rectangular box and link */
        }
        #packages {
        text-align: center;
        padding: 40px 0;
        }

        .carousel-container {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
            overflow: hidden;
        }

        .carousel-slider {
            display: flex;
            transition: transform 0.5s ease;
        }

        .trip-card {
            flex: 0 0 calc(33.333% - 20px);
            margin: 0 10px;
            background-color: #1a1a1a;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.3s ease;
        }

        .trip-card:hover {
            transform: translateY(-5px);
        }

        .trip-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .trip-details {
            padding: 15px;
        }

        .trip-details h3 {
            margin-top: 0;
            color: #e0e0e0;
        }

        .trip-details p {
            margin: 5px 0;
            color: #b0b0b0;
        }

        .show-details-btn {
            background-color: #009be3;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .show-details-btn:hover {
            background-color: #007bb5;
        }

        .arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0,0,0,0.5);
            color: white;
            border: none;
            padding: 10px 15px;
            font-size: 20px;
            cursor: pointer;
            z-index: 10;
        }

        .left-arrow {
            left: 10px;
        }

        .right-arrow {
            right: 10px;
        }
    </style>
    <title>Trip_with_me</title>
    <link rel="icon" href="static/images/aes11.png" type="image/icon type">
</head>
<body style="background:black;color:white;font-family: 'Courier New', Courier, monospace;">
    <nav class="navbar navbar-expand-lg fixed-top" style="background:black;height: 68px;">
        <div class="container-fluid">
            <a class="navbar-brand" href="#home"><image src="static/images/aes11.png" style="width:50px;height:50px;"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" style="color:white;" href="#home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" style="color:white;" onclick="handleScheduleTrip()">Schedule Trip</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" style="color:white;" onclick="handleFindTrip()">Find Trip</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" style="color:white;" href="#about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" style="color:white;" href="#packages">Packages</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" style="color:white;" href="#contact">Contact</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" style="color:white;" href="#" onclick="handleBookings(); return false;">Bookings</a>
                    </li>
                    {% if session.get('user') %}
                    <!-- <li class="nav-item" style="margin-left: 650px;">
                    <p>{{user_name}}</p></li> -->
                    <li class="nav-item" style="margin-left: 665px;">
                        
                        <a id="notification" class="notification-icon no-message" href="{{ url_for('notifications') }}">
                            <i class="fas fa-bell"></i>
                        </a>
                        
                        <img src="{{ url_for('static', filename='images/' + user_image) }}" data-bs-toggle="dropdown" aria-expanded="false" alt="Logout" style="cursor: pointer; width: 40px; height: 40px;border-radius: 50%;margin-left: 20px;">
                        <ul  style=" margin-left: 1350px;" class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('logout') }}">LogOut</a></li>
                            <li><a class="dropdown-item"  href="{{ url_for('updateuser') }}">Account Info</a></li>
                          </ul>
                    </li>
                    {% else %}
                    <li class="nav-item" style=" margin-left: 725px;">
                        <a class="nav-link" style="color:white;" href="{{ url_for('login') }}">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" style="color:white;" href="{{ url_for('register') }}">Register</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div id="messages" class="container mt-3 section">
        <h1  style="margin-top: 119px;">Welcome to TRIP WITH ME</h1>
        <p>With you Beyond horizon!!</p>
        <img src="static/images/aes11.png" style="margin-left: 867px;height:300px;width300px;margin-top: -181px;">
    </div>

    <div class="container mt-3 section" id="travel-partner">
        <h2>Find Travel Mate</h2>
        <div style="width:616px">
        <p style="text-align:justify;"> Feeling boared at work, Escape to the happiness of the world. Always needed a Vacation don't waste any more time do it now it self. Find a partner for your trip for your dream destination. </p>
        </div>
        <div style="margin-left: 899px;margin-top: -100px;">
            <button type="button" class="btn btn-outline-light" style="width: 352px;" id="scheduletrip" onclick="handleScheduleTrip()">Schedule Trip</button><br><br>
            <button type="button" class="btn btn-outline-light" style="width: 353px;" id="findtrip" onclick="handleFindTrip()">Find Trip</button>
        </div>
    </div>


    <div id="about" class="container mt-3 section">
        <h2>About</h2>
        <p>
            Welcome to Trip With Me, a comprehensive web platform aimed at transforming travel planning and partner matching through innovative technology integration. The platform enables users to seamlessly access a variety of functionalities, including finding travel partners, booking curated tour packages, obtaining cab services, and managing financial transactions directly from their devices. Utilizing machine learning, Trip With Me offers personalized recommendations, dynamic pricing, and fraud detection to enhance user convenience and security. A standout feature of Trip With Me is its ability to assist users in securing loans for tour packages with automated approval processes. For administrators, Trip With Me provides a robust web interface to monitor and analyze various metrics, ensuring efficient platform management and data-driven decision-making. By integrating these features, Trip With Me enhances the travel experience by providing a secure, personalized, and efficient platform for tourists, administrators, and service providers.
        </p>
    </div>
    <div id="packages" class="container mt-3 section">
        <h2>Packages</h2>
        <div class="carousel-container">
            <button class="arrow left-arrow">&lt;</button>
            <div class="carousel-slider">
                <!-- Trip cards will be dynamically inserted here -->
            </div>
            <button class="arrow right-arrow">&gt;</button>
        </div>
        <div class="view-all-link">
            <a href="{{ url_for('all_trips') }}">View All</a>
        </div>
    </div>

    <div id="contact" class="container mt-3 section">
        <h2>Contact</h2>
        <p>
            We'd love to hear from you! For any inquiries, support, or feedback, please reach out to us through any of the following channels:
        </p>
        <p>
            Phone: +1 (800) 123-4567<br>
            Email: tripwithme@gmail.com<br>
            Instagram: @tripwithme_official<br>
            Twitter: @TripWithMe<br>
            Stay connected and join our community for the latest updates and travel inspiration.
        </p>
    </div>  
        <div style="background:#009be3;height: 39px;">
            &copy; 2024 Trip With Me. All rights reserved.
            <a href="#" style="margin-left: 850px;">Terms of Service</a> | <a href="#">Privacy Policy</a>
            </div>
        </div>

    <script>
        // Ensure smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();

                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
        // Check if the user is logged in
        var isLoggedIn = {{ 'true' if user_logged_in else 'false' }};
        
        function handleScheduleTrip() {
            if (isLoggedIn) {
                window.open("{{ url_for('scheduletrip') }}", "_blank");
            } else {
                window.location.href = "{{ url_for('login') }}";
            }
        }

        function handleFindTrip() {
            if (isLoggedIn) {
                window.location.href = "{{ url_for('findtrip') }}";
            } else {
                window.location.href = "{{ url_for('login') }}";
            }
        }
    </script>

    <!-- Notification Script -->
     
    <script>
        function checkForMessages() {
            fetch('/check_messages')
                .then(response => response.json())
                .then(data => {
                    const hasNewMessages = data.has_new_messages;
                    const notificationElement = document.getElementById('notification');

                    if (notificationElement) {
                        if (hasNewMessages) {
                            notificationElement.classList.remove('no-message');
                            notificationElement.classList.add('new-message');
                        } else {
                            notificationElement.classList.remove('new-message');
                            notificationElement.classList.add('no-message');
                        }
                    } else {
                        console.error('Notification element not found');
                    }
                })
                .catch(error => {
                    console.error('Error checking messages:', error);
                });
        }

        // Check for messages on page load
        document.addEventListener('DOMContentLoaded', checkForMessages);
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    let currentIndex = 0;
    let trips = [];

    fetch('/get_trips')
    .then(response => response.json())
    .then(data => {
        trips = Object.values(data);
        renderTrips();
        setupCarousel();
    })
    .catch(error => console.error('Error fetching trips:', error));

    function renderTrips() {
        const slider = document.querySelector('.carousel-slider');
        slider.innerHTML = '';
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(0, 0, 0, 0);

        trips.forEach(trip => {
            const tripStartDate = new Date(trip.start_date);
            if (tripStartDate >= tomorrow) {
                const card = document.createElement('div');
                card.className = 'trip-card';
                card.innerHTML = `
                    <img src="/static/images/${trip.image1}" alt="${trip.location}">
                    <div class="trip-details">
                        <h3>${trip.location}</h3>
                        <p>Total Amount: $${calculateTotalAmount(trip).toFixed(2)}</p>
                        <p>From: ${trip.start_date} <br>To: ${trip.end_date}</p>
                        <button class="show-details-btn" onclick="redirectToDetails('${trip.id}')">Show Details</button>
                    </div>
                `;
                slider.appendChild(card);
            }
        });
    }

    function setupCarousel() {
        const leftArrow = document.querySelector('.left-arrow');
        const rightArrow = document.querySelector('.right-arrow');
        const slider = document.querySelector('.carousel-slider');

        leftArrow.addEventListener('click', () => moveCarousel(-1));
        rightArrow.addEventListener('click', () => moveCarousel(1));

        function moveCarousel(direction) {
            currentIndex = (currentIndex + direction + trips.length) % trips.length;
            updateCarousel();
        }

        function updateCarousel() {
            const offset = -currentIndex * (100 / 3);
            slider.style.transform = `translateX(${offset}%)`;
        }
    }

    function calculateTotalAmount(trip) {
        const basicAmount = parseFloat(trip.basic_amount);
        const tax = (parseFloat(trip.tax_percentage) / 100) * basicAmount;
        const discount = (parseFloat(trip.discount) / 100) * basicAmount;
        return basicAmount + tax - discount;
    }
});

function redirectToDetails(tripId) {
    if (isUserLoggedIn()) {
        window.location.href = `/trip_details/${tripId}`;
    } else {
        window.location.href = '/login';
    }
}

function isUserLoggedIn() {
    return {{ 'true' if session.get('user') else 'false' }};
}
</script>
<script>
    function handleBookings() {
        if (isUserLoggedIn()) {
            window.location.href = "{{ url_for('bookings') }}";
        } else {
            window.location.href = "{{ url_for('login') }}";
        }
    }
    
    // Make sure this function is defined
    function isUserLoggedIn() {
        return {{ 'true' if session.get('user') else 'false' }};
    }
    </script>
</body>
</html>
